# DDD

DDD不是架构，而是一种**架构设计方法**论，它通过边界划分将复杂业务领域简单换化，帮我们设计出清晰的领域和应用边界，可以很容易地实现架构演变。

## 领域

领域就是用来确认范围，范围就是边界，DDD的领域就是这个边界内要解决的业务问题域。

领域也可拆分为很多的字领域，一个领域相当于一个问题域，领域才分为子域的过程就是大问题才分为小问题的过程。

领域在细分为子域的过程中，子域可以更具自身重要性和功能属性划分为三类子域，分别是 ：**核心域**、**通用域**、**支撑域**；

### 核心域
核心域：决定产品和公司核心竞争力的子域就是核心域，它是业务成功的主要因素和公司的核心竞争力。
通用域：同时被多个子域使用的通用功能子域就是通用域。如**认证**和**权限**
支撑域：该子域是必须的，但是既不包含决定产品和公司核心竞争力的功能，也不包含同于功能的子域。如**数字字典**

## 聚合根和领域服务

聚合根与领域服务复杂封装实现业务逻辑。领域服务负责对聚合根进行调度和封装，同时可以对外提供各种形式的服务，对于不能直接通过聚合根完成的业务操作就需要通过领域服务。


聚合根本身无法完成处理这个逻辑，例如支付这个步骤，订单聚合不可能支付，所以在订单聚合上架一层领域服务，在领域服务中实现支付逻辑，然后应用服务调用领域服务。

同限界上下文内的聚合之间的领域服务可直接调用。
两个界限上下文的交互必须通过应用服务层抽离接口-》**适配层适配**



例如：用户升职，用户的领导会发生变化，用户领导的下属会发生变化。
```java

@Service
public class UserDomainServiceImpl implements UserDomainService {

    @Override
    public void promote(User user, User leader) {

        //保存领导
        user.saveLeader(leader);

        //领导增加下属
        leader.increaseSubordination(user);
    }
}

```

### 限界上下文

我们可以将界限上下文拆解为两个词：**界限**和**上下文**。
界限：就是领域的边界，
上下文：语义环境
通过领域的界限上下文，我们就可以在统一的领域边界内用统一的语言进行交流，
界限上下文：用来封装同于预压和领域对象，提供上下文环境，保证在领域之内的一些属于、业务相关对象有一个确切的含义，这个边界定义了模型的适用范围，是团队所有成员能够明确地知道什么应该在模型中实现，什么不应该在模型中实现。

领域边界时通过限界上下文来定义的，理论上限界上下文就是微服务的边界，我们将限界上下文内的领域模型映射到微服务，就完成了从问题域到软件的解决方案。
